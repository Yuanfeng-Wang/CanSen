<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Postprocessing &mdash; CanSen 1.0.0 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="CanSen 1.0.0 documentation" href="index.html" />
    <link rel="next" title="Code Documentation" href="codedocs.html" />
    <link rel="prev" title="Supported SENKIN Keywords" href="keywords.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="codedocs.html" title="Code Documentation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="keywords.html" title="Supported SENKIN Keywords"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">CanSen</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="postprocessing">
<span id="sec-postprocessing"></span><h1>Postprocessing<a class="headerlink" href="#postprocessing" title="Permalink to this headline">Â¶</a></h1>
<p>CanSen saves the solution information to a binary save file in a
standard format called <a href="#id1"><span class="problematic" id="id2">`HDF5`_</span></a>. Many programming and scripting
languages have interfaces for HDF5 files, including <a class="reference external" href="http://ftp.hdfgroup.org/HDF5/doc/cpplus_RM/index.html">C++</a>, <a class="reference external" href="http://www.mathworks.com/help/matlab/hdf5-files.html;jsessionid=a596eeee2bf156629abd647818b6">MATLAB</a>,
<a class="reference external" href="http://www.hdf5.com/HDF5/doc/fortran/index.html">Fortran 90</a> and Python. Notably, these are all of the interfaces that
Cantera supports. The Python interface will be demonstrated in this
tutorial, but the structure of the data and thus the main content of
this tutorial will remain the same for all of the interfaces.</p>
<p>There are several Python interfaces for HDF5, but the one we will be
using is called PyTables. The documentation for PyTables can be found
on <a class="reference external" href="http://pytables.github.io/usersguide/index.html">their GitHub</a> page.</p>
<p>Note that on the following lines, the <tt class="docutils literal"><span class="pre">&gt;&gt;&gt;</span></tt> indicates that you should
type the text at a Python prompt, not including the <tt class="docutils literal"><span class="pre">&gt;&gt;&gt;</span></tt>. First, we
will import the necessary libraries:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tables</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">cantera</span> <span class="kn">as</span> <span class="nn">ct</span>
</pre></div>
</div>
<p>If either of these don&#8217;t work, make sure that PyTables and Cantera are
both properly installed.</p>
<p>To print information about the save file, just type the name of
its variable</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">save_file</span>
</pre></div>
</div>
<p>The data is saved in the save file with the Table format. Each
Row in the Table represents one time step. Each Row further
consists of a number of Columns where the data is stored. The
Columns can be of arbitrary shape - thus, the entire 2-D
sensitivity array is saved in one Column on each time step (i.e.
in each row).</p>
<p>The format of the save file is hierarchical. The Table with each
time step is stored in a Group, which is stored in the Root. It
can be thought of as nested directories, with the Root as the top
directory, then the Group, then the Table, like so:</p>
<div class="highlight-python"><div class="highlight"><pre>Root
    |-Group
          |-Table
</pre></div>
</div>
<p>To access the information in the Table, it should be stored in a
variable for quick access. The name of the Group in the save
files from CanSen is <tt class="docutils literal"><span class="pre">reactor</span></tt>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">save_file</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">reactor</span>
</pre></div>
</div>
<p>The Table can now be used like any other class instance. In
particular, the Table class defines a number of useful functions
and attributes, such as <tt class="docutils literal"><span class="pre">nrows</span></tt>, which prints the number of
rows in the Table.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">nrows</span>
</pre></div>
</div>
<p>PyTables provides a method to iterate over the rows in a table
automatically, called <tt class="docutils literal"><span class="pre">iterrows</span></tt>. Here we introduce one way to
access information in a particular Column in the Table, by using
natural name indexing. In this case, we print the value of the
time at each time step.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
<span class="go">        print(row[&#39;time&#39;])</span>
</pre></div>
</div>
<p>Note that numerical indexing is also supported. The following is
equivalent to the above:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
<span class="go">        print(row[0])</span>
</pre></div>
</div>
<p>The information stored by CanSen is written into case-sensitive
columns named:</p>
<ol class="arabic simple" start="0">
<li><tt class="docutils literal"><span class="pre">time</span></tt></li>
<li><tt class="docutils literal"><span class="pre">temperature</span></tt></li>
<li><tt class="docutils literal"><span class="pre">pressure</span></tt></li>
<li><tt class="docutils literal"><span class="pre">volume</span></tt></li>
<li><tt class="docutils literal"><span class="pre">massfractions</span></tt></li>
<li><tt class="docutils literal"><span class="pre">sensitivity</span></tt></li>
</ol>
<p>Columns 0-3 have a single value in each row. Column 4
(<tt class="docutils literal"><span class="pre">massfractions</span></tt>) contains a vector with length of the number of
species in the mechanism. Column 5 is optional and included only
if the user requested sensitivity analysis during the simulation.
The dimensions of Column 5 are <tt class="docutils literal"><span class="pre">(n_vars,</span> <span class="pre">n_sensitivity_params)</span></tt>.</p>
<p>In addition to the method of iterating through Rows, entire
Columns can be accessed and stored in variables. First, all of
the Columns can be stored in a variable.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">all_cols</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">cols</span>
</pre></div>
</div>
<p>In this method, different Columns are accessed by their numerical
index. The first index to <tt class="docutils literal"><span class="pre">all_cols</span></tt> gives the row and the
second index gives the column number. Remembering that Python is
zero-based, to access the mass fractions on the 4th time step, do</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mass_fracs_4</span> <span class="o">=</span> <span class="n">all_cols</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<p>Individual Columns can be stored in variables as well. This is
done by the natural naming scheme.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">all_mass_fracs</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">cols</span><span class="o">.</span><span class="n">massfractions</span>
</pre></div>
</div>
<p>This stores an instance of the Column class in <tt class="docutils literal"><span class="pre">all_mass_fracs</span></tt>.
It may be more useful to store the data in a particular column in
a variable. To do that, get a slice of the column by using the
index and the colon operator. For instance, to store all of the
mass fraction data in a variable</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">all_mass_fracs</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">cols</span><span class="o">.</span><span class="n">massfractions</span><span class="p">[:]</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Or, to store the fifth through tenth time steps</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mass_fracs_5_10</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">cols</span><span class="o">.</span><span class="n">massfractions</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
</dd>
</dl>
<p>Or, to store every other time step from the sixth through the
20th</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mass_fracs_alt</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">cols</span><span class="o">.</span><span class="n">massfractions</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<p>Once the data has been extracted from the save file, we need to
actually be able to do something with it. Fortunately, Cantera
offers a simple way to do this, by initializing a Solution to the
desired conditions.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">gas</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s">&#39;mech.xml&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
<span class="go">        gas.TPY = row[&#39;temperature&#39;], row[&#39;pressure&#39;], row[&#39;massfractions&#39;]</span>
<span class="go">        print(gas.creation_rates)</span>
</pre></div>
</div>
<p>This will print the creation rates of each species at each time
step. Any method or parameter supported by the Solution class
can be used to retrieve data at any given time step.</p>
<p>Further information about the PyTables package can be found at
<a class="reference external" href="http://pytables.github.io/usersguide/index.html">http://pytables.github.io/usersguide/index.html</a> and information
about Cantera can be found at
<a class="reference external" href="http://cantera.github.io/docs/sphinx/html/index.html">http://cantera.github.io/docs/sphinx/html/index.html</a></p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="keywords.html"
                        title="previous chapter">Supported SENKIN Keywords</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="codedocs.html"
                        title="next chapter">Code Documentation</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/postprocessing.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="codedocs.html" title="Code Documentation"
             >next</a> |</li>
        <li class="right" >
          <a href="keywords.html" title="Supported SENKIN Keywords"
             >previous</a> |</li>
        <li><a href="index.html">CanSen</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Bryan W. Weber.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.1.
    </div>
  </body>
</html>